[gd_scene load_steps=15 format=3 uid="uid://3rax0onuo76f"]

[ext_resource type="PackedScene" uid="uid://dj405lsp20gkg" path="res://characters/player/player_model.tscn" id="1_hyk8p"]
[ext_resource type="PackedScene" uid="uid://b3pq3lm4pjpdk" path="res://characters/enemies/basic_enemy/enemy.tscn" id="2_iuonh"]
[ext_resource type="PackedScene" uid="uid://djqe8wkjmmn8n" path="res://shared/rope_vfx/rope_vfx.tscn" id="7_b1x3f"]
[ext_resource type="PackedScene" uid="uid://d2ucnrebee3ji" path="res://shared/vfx/blood/blood_vfx.tscn" id="7_ouso4"]
[ext_resource type="Shader" uid="uid://b5b3i0xpignlr" path="res://shared/rope_vfx/rope.gdshader" id="8_a8run"]
[ext_resource type="Script" uid="uid://cfqche3hcpffv" path="res://scenes/debug/vfx/blood&rope/blood_test.gd" id="8_blune"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_ouso4"]

[sub_resource type="CapsuleMesh" id="CapsuleMesh_vom5j"]
material = SubResource("ShaderMaterial_ouso4")
radius = 0.3
height = 1.8

[sub_resource type="NavigationMesh" id="NavigationMesh_iuonh"]
vertices = PackedVector3Array(-4.5, 0.70000005, -4.5, -4.5, 0.70000005, 4.5, 4.5, 0.70000005, 4.5, 4.5, 0.70000005, -4.5)
polygons = [PackedInt32Array(3, 2, 0), PackedInt32Array(0, 2, 1)]
cell_height = 0.1

[sub_resource type="BoxMesh" id="BoxMesh_vom5j"]
size = Vector3(10, 1, 10)

[sub_resource type="BoxShape3D" id="BoxShape3D_hyk8p"]
size = Vector3(10, 1, 10)

[sub_resource type="CylinderMesh" id="CylinderMesh_blune"]
resource_local_to_scene = true
top_radius = 0.05
bottom_radius = 0.05
height = 1.0
radial_segments = 8
rings = 10

[sub_resource type="ShaderMaterial" id="ShaderMaterial_th5th"]
resource_local_to_scene = true
render_priority = 0
shader = ExtResource("8_a8run")
shader_parameter/mesh_width_change = 2.0
shader_parameter/anim_start = 0.0
shader_parameter/length_start = 10.0
shader_parameter/length_curr = 10.0
shader_parameter/segment_density = 10.0
shader_parameter/width = 0.01
shader_parameter/softness = 0.5
shader_parameter/speed = 5.0
shader_parameter/main_col_def = Color(0.34117648, 0.7176471, 0.41568628, 1)
shader_parameter/main_col_stretch = Color(0.34509805, 0.60784316, 0.7176471, 1)
shader_parameter/main_col_squish = Color(0.7490196, 0.3764706, 0.43529412, 1)
shader_parameter/sec_col_def = Color(1, 1, 1, 1)
shader_parameter/sec_col_stretch = Color(1, 1, 1, 1)
shader_parameter/sec_col_squish = Color(1, 1, 1, 1)
shader_parameter/vibrate_time = 0.3

[sub_resource type="GDScript" id="GDScript_3jfvp"]
script/source = "extends Node

@export var rope: RopeVFX
@export var blood: CPUParticles3D

var length = 2.0;

func _input(event):
	if event is InputEventKey and event.pressed:
		if event.keycode == KEY_T:
			length = 2.0
			rope.start(length)
		elif event.keycode == KEY_E:
			length+=.2
			rope.set_length(length)
		elif event.keycode == KEY_Q:
			length-=.2
			rope.set_length(length)
		elif event.keycode == KEY_R:
			rope.end()
"

[node name="Main" type="Node3D"]

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.90547997, 0.42438912, 0, -0.42438912, 0.90547997, 0, 0, 0)

[node name="HumanHeight" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.47107148, 1.3952317, 0)
mesh = SubResource("CapsuleMesh_vom5j")

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="."]
navigation_mesh = SubResource("NavigationMesh_iuonh")

[node name="10x10_floor" type="StaticBody3D" parent="NavigationRegion3D"]

[node name="MeshInstance3D" type="MeshInstance3D" parent="NavigationRegion3D/10x10_floor"]
mesh = SubResource("BoxMesh_vom5j")

[node name="CollisionShape3D" type="CollisionShape3D" parent="NavigationRegion3D/10x10_floor"]
shape = SubResource("BoxShape3D_hyk8p")

[node name="AlienHeight" parent="." instance=ExtResource("1_hyk8p")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.32957077, 0.8731664, -0.07348645)

[node name="Enemy" parent="." instance=ExtResource("2_iuonh")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2.0859199, 0.46004307, 0)

[node name="CPUParticles3D" parent="Enemy" instance=ExtResource("7_ouso4")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)

[node name="Node3D" type="Node3D" parent="Enemy/CPUParticles3D" node_paths=PackedStringArray("particles")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
script = ExtResource("8_blune")
particles = NodePath("..")

[node name="RopeVFX" parent="." instance=ExtResource("7_b1x3f")]
transform = Transform3D(0.9475399, 0.31963745, 0, -0.3046366, 0.9030711, 0.3027525, 0.09677103, -0.28687006, 0.9530692, 1.1018821, 1.412394, 0.09567356)
mesh = SubResource("CylinderMesh_blune")
mat = SubResource("ShaderMaterial_th5th")

[node name="Node3D" type="Node3D" parent="RopeVFX" node_paths=PackedStringArray("rope")]
script = SubResource("GDScript_3jfvp")
rope = NodePath("..")
